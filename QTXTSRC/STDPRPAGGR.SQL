/******************************************************************************/
/*                                                                            */
/*  Inuendo 1.2 (Alpha release) - STANDARD PROPERTY AGGREGATE FUNCTIONS (SQL) */
/*                                                                            */
/*  Copyright (C) 2012, 2019  Christopher F. Burns Sr.                        */
/*    c/o The Inuendo Project (http://inuendo.us).                            */
/*                                                                            */
/*  This program is free software: you can redistribute it and/or modify      */
/*  it under the terms of the GNU General Public License as published by      */
/*  the Free Software Foundation, either version 3 of the License, or         */
/*  (at your option) any later version.                                       */
/*                                                                            */
/*  This program is distributed in the hope that it will be useful,           */
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of            */
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the             */
/*  GNU General Public License for more details.                              */
/*                                                                            */
/*  You should have received a copy of the GNU General Public License         */
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.     */
/*                                                                            */
/******************************************************************************/


/******************************************************************************/
/*  AVERAGE FUNCTIONS                                                         */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYAVGDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYAVGDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYAVGDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYAVGDURING
  IS 'Property Average During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYAVGDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYAVGTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYAVGTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYAVGTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYAVGDURING
  IS 'Property Average Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYAVGTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYAVGSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYAVGSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYAVGSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYAVGSINCE
  IS 'Property Average Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYAVGSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYAVG (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYAVG
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYAVG)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYAVG
  IS 'Property Average' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYAVG
TO PUBLIC ;


/******************************************************************************/
/*  MINIMUM FUNCTIONS                                                         */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYMINDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMINDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMINDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMINDURING
  IS 'Property Minimum During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMINDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMINTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMINTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMINTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMINDURING
  IS 'Property Minimum Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMINTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMINSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMINSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMINSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMINSINCE
  IS 'Property Minimum Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMINSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMIN (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMIN
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMIN)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMIN
  IS 'Property Minimum' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMIN
TO PUBLIC ;


/******************************************************************************/
/*  MAXIMUM FUNCTIONS                                                         */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYMAXDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMAXDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMAXDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMAXDURING
  IS 'Property Maximum During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMAXDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMAXTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMAXTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMAXTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMAXDURING
  IS 'Property Maximum Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMAXTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMAXSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMAXSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMAXSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMAXSINCE
  IS 'Property Maximum Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMAXSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMAX (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMAX
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMAX)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMAX
  IS 'Property Maximum' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMAX
TO PUBLIC ;


/******************************************************************************/
/*  SUM FUNCTIONS                                                             */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYSUMDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYSUMDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYSUMDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYSUMDURING
  IS 'Property Sum During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYSUMDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYSUMTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYSUMTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYSUMTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYSUMDURING
  IS 'Property Sum Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYSUMTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYSUMSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYSUMSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYSUMSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYSUMSINCE
  IS 'Property Sum Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYSUMSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYSUM (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYSUM
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYSUM)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYSUM
  IS 'Property Sum' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYSUM
TO PUBLIC ;


/******************************************************************************/
/*  COUNT FUNCTIONS                                                           */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYCOUNTDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYCOUNTDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYCOUNTDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYCOUNTDURING
  IS 'Property Count During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYCOUNTDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYCOUNTTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYCOUNTTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYCOUNTTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYCOUNTDURING
  IS 'Property Count Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYCOUNTTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYCOUNTSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYCOUNTSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYCOUNTSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYCOUNTSINCE
  IS 'Property Count Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYCOUNTSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYCOUNT (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYCOUNT
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYCOUNT)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYCOUNT
  IS 'Property Count' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYCOUNT
TO PUBLIC ;


/******************************************************************************/
/*  MEAN FUNCTIONS                                                            */
/******************************************************************************/

CREATE OR REPLACE FUNCTION PROPERTYMEANDURING (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP,
  TOMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMEANDURING
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMEANDURING)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMEANDURING
  IS 'Property Mean During' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMEANDURING
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMEANTHROUGH (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  THRUMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMEANTHROUGH
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMEANTHROUGH)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMEANDURING
  IS 'Property Mean Through' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMEANTHROUGH
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMEANSINCE (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) ,
  FROMMOMENT TIMESTAMP )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMEANSINCE
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMEANSINCE)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMEANSINCE
  IS 'Property Mean Since' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMEANSINCE
TO PUBLIC ;


CREATE OR REPLACE FUNCTION PROPERTYMEAN (
  ENTITYID BIGINT,
  PROPERTY VARCHAR(254) )
  RETURNS DECIMAL(25, 7)
  LANGUAGE RPGLE
  SPECIFIC PROPERTYMEAN
  NOT DETERMINISTIC
  NOT FENCED
  PROGRAM TYPE SUB
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  EXTERNAL NAME STDPRPAGGR(PROPERTYMEAN)
  PARAMETER STYLE GENERAL ;

COMMENT ON SPECIFIC FUNCTION PROPERTYMEAN
  IS 'Property Mean' ;

GRANT ALTER , EXECUTE
ON SPECIFIC FUNCTION PROPERTYMEAN
TO PUBLIC ;

